<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2024-04-03T16:56:02.407735025"><title>Exemple 6 : Fichiers | Help Instance</title><script type="application/json" id="virtual-toc-data">[{"id":"getopenbuttonfunc-et-getopenfiledialogfunc-plus-en-d-tails","level":0,"title":"getOpenButtonFunc et getOpenFileDialogFunc plus en détails","anchor":"#getopenbuttonfunc-et-getopenfiledialogfunc-plus-en-d-tails"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b224/app.css" rel="stylesheet"><link rel="manifest" href="site.webmanifest"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Exemple 6 : Fichiers | Help Instance"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Help Instance Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/ch09s06-exemple-6-fichiers.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Exemple 6 : Fichiers | Help Instance"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/ch09s06-exemple-6-fichiers.html#webpage",
    "url": "writerside-documentation/ch09s06-exemple-6-fichiers.html",
    "name": "Exemple 6 : Fichiers | Help Instance",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Help Instance Help"
}</script><!-- End Schema.org --></head><body data-id="ch09s06-Exemple-6-Fichiers" data-main-title="Exemple 6 : Fichiers" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="ch09-Chapitre-9-Interfaces-graphiques.md|Chapitre 9 : Interfaces graphiques"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Help Instance  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="ch09s06-Exemple-6-Fichiers" id="ch09s06-Exemple-6-Fichiers.md">Exemple 6 : Fichiers</h1><p id="-211zd0_475"><a href="https://github.com/profdenis/native1/tree/master/chap9/06_fichiers" id="-211zd0_476" data-external="true" rel="noopener noreferrer">Code</a></p><p id="-211zd0_477">Ce programme Go est un &eacute;diteur Markdown simple utilisant la bo&icirc;te &agrave; outils GUI Fyne.</p><p id="-211zd0_478">La fonction <code class="code" id="-211zd0_479">main</code> est le point d'entr&eacute;e de l'application Go. Elle initialise une nouvelle application Fyne <code class="code" id="-211zd0_480">a</code>, cr&eacute;e une nouvelle fen&ecirc;tre <code class="code" id="-211zd0_481">w</code>, cr&eacute;e deux entr&eacute;es <code class="code" id="-211zd0_482">src</code> et <code class="code" id="-211zd0_483">dst</code> avec la fonction <code class="code" id="-211zd0_484">makeSrcDstEntries</code>, et arrange ces entr&eacute;es &agrave; l'int&eacute;rieur d'un <span class="emphasis" id="-211zd0_485">container</span> <code class="code" id="-211zd0_486">split</code> horizontal.</p><p id="-211zd0_487">Le contenu de la fen&ecirc;tre <code class="code" id="-211zd0_488">w</code> est d&eacute;fini par les <span class="emphasis" id="-211zd0_489">containers</span> qui contiennen des boutons et le container <code class="code" id="-211zd0_490">split</code>. Deux boutons, <span class="emphasis" id="-211zd0_491">&quot;Ouvrir&quot;</span> et <span class="emphasis" id="-211zd0_492">&quot;Enregistrer&quot;</span> sont responsables de l'appel des fonctions <code class="code" id="-211zd0_493">getOpenButtonFunc</code> et une fonction anonyme une fois cliqu&eacute;s, respectivement, qui g&egrave;rent les op&eacute;rations de lecture/&eacute;criture. Le <code class="code" id="-211zd0_494">w.Resize(fyne.NewSize(800, 600))</code> ajuste la taille de la fen&ecirc;tre et <code class="code" id="-211zd0_495">w.ShowAndRun()</code> fait appara&icirc;tre la fen&ecirc;tre et ex&eacute;cute la boucle principale de l'&eacute;v&eacute;nement de l'application.</p><div class="code-block" data-lang="go">
func getOpenButtonFunc(w fyne.Window, src *widget.Entry, dst *widget.RichText) func() {...}
</div><p id="-211zd0_497">La fonction <code class="code" id="-211zd0_498">getOpenButtonFunc</code> met en place la fonctionnalit&eacute; du bouton &quot;Ouvrir&quot;, qui ouvrira une bo&icirc;te de dialogue de fichier o&ugrave; les utilisateurs peuvent choisir un fichier markdown (&quot;.md&quot;) &agrave; charger dans la fen&ecirc;tre Fyne.</p><div class="code-block" data-lang="go">
func getOpenFileDialogFunc(w fyne.Window, src *widget.Entry, dst *widget.RichText) func(reader fyne.URIReadCloser, err error) {...}
</div><p id="-211zd0_500">La fonction <code class="code" id="-211zd0_501">getOpenFileDialogFunc</code> est utilis&eacute;e pour g&eacute;rer l'ouverture du fichier s&eacute;lectionn&eacute; &agrave; partir de la bo&icirc;te de dialogue. Elle lit le fichier (en supposant un fichier markdown) et d&eacute;finit le contenu &agrave; <code class="code" id="-211zd0_502">src</code> et <code class="code" id="-211zd0_503">dst</code>. Elle imprime &eacute;galement toutes les erreurs rencontr&eacute;es.</p><div class="code-block" data-lang="go">
func makeSrcDstEntries() (*widget.Entry, *widget.RichText) {...}
</div><p id="-211zd0_505">La fonction <code class="code" id="-211zd0_506">makeSrcDstEntries</code> d&eacute;finit les entr&eacute;es <code class="code" id="-211zd0_507">src</code> et <code class="code" id="-211zd0_508">dst</code> en tant que widgets Fyne : <code class="code" id="-211zd0_509">src</code> est un champ d'entr&eacute;e multiligne et <code class="code" id="-211zd0_510">dst</code> est un champ RichText. La propri&eacute;t&eacute; <code class="code" id="-211zd0_511">src.OnChanged</code> est d&eacute;finie &agrave; une fonction pour mettre &agrave; jour <code class="code" id="-211zd0_512">dst</code> chaque fois que le contenu de <code class="code" id="-211zd0_513">src</code> change (en supposant un contenu markdown).</p><div class="code-block" data-lang="go">
func getCurrentDirURI() (fyne.ListableURI, error) {...}
</div><p id="-211zd0_515">La fonction <code class="code" id="-211zd0_516">getCurrentDirURI</code> est utilis&eacute;e pour obtenir l'URI du r&eacute;pertoire courant. Elle est appel&eacute;e &agrave; la fois par la fonction <code class="code" id="-211zd0_517">getOpenButtonFunc</code> ainsi que par la fonction &quot;Enregistrer&quot; pour d&eacute;finir l'emplacement initial des bo&icirc;tes de dialogue de fichier.</p><p id="-211zd0_518">La derni&egrave;re fonction anonyme associ&eacute;e au bouton <span class="emphasis" id="-211zd0_519">&quot;Enregistrer&quot;</span> est utilis&eacute;e pour g&eacute;rer l'enregistrement des fichiers. Lorsque le bouton est cliqu&eacute;, une bo&icirc;te de dialogue d'enregistrement de fichier s'ouvre et permet aux utilisateurs de choisir un emplacement pour sauvegarder un fichier. Il cr&eacute;e ou &eacute;crase un fichier .md avec le texte actuellement dans le widget d'entr&eacute;e <code class="code" id="-211zd0_520">src</code>.</p><section class="chapter"><h2 id="getopenbuttonfunc-et-getopenfiledialogfunc-plus-en-d-tails" data-toc="getopenbuttonfunc-et-getopenfiledialogfunc-plus-en-d-tails"><code class="code" id="-211zd0_522">getOpenButtonFunc</code> et <code class="code" id="-211zd0_523">getOpenFileDialogFunc</code> plus en d&eacute;tails</h2><div class="code-block" data-lang="go">
func getOpenButtonFunc(w fyne.Window, src *widget.Entry, dst *widget.RichText) func() {
	return func() {
		fd := dialog.NewFileOpen(getOpenFileDialogFunc(w, src, dst), w)
		fd.SetFilter(storage.NewExtensionFileFilter([]string{&quot;.md&quot;}))
		listableUri, err := getCurrentDirURI()
		if err != nil {
			dialog.ShowError(err, w)
			return
		}
		fd.SetLocation(listableUri)
		fd.Show()
	}
}
</div><p id="-211zd0_525">Ici, <code class="code" id="-211zd0_526">getOpenButtonFunc</code> retourne une fonction qui, lorsqu'elle est invoqu&eacute;e, cr&eacute;e une bo&icirc;te de dialogue de fichier en appelant <code class="code" id="-211zd0_527">dialog.NewFileOpen()</code>. La bo&icirc;te de dialogue cr&eacute;&eacute;e sera utilis&eacute;e pour ouvrir un fichier <code class="code" id="-211zd0_528">.md</code> s&eacute;lectionn&eacute; par l'utilisateur.</p><ul class="list _bullet" id="-211zd0_529"><li class="list__item" id="-211zd0_530"><p><code class="code" id="-211zd0_531">getOpenFileDialogFunc(w, src, dst)</code> est une fonction de rappel pour g&eacute;rer l'ouverture du fichier.</p></li><li class="list__item" id="-211zd0_532"><p><code class="code" id="-211zd0_533">fd.SetFilter(storage.NewExtensionFileFilter([]string{&quot;.md&quot;}))</code> restreint les fichiers visibles &agrave; ceux ayant une extension <code class="code" id="-211zd0_534">.md</code>.</p></li><li class="list__item" id="-211zd0_535"><p><code class="code" id="-211zd0_536">getCurrentDirURI()</code> est utilis&eacute; pour obtenir l'URI du r&eacute;pertoire de travail actuel et le d&eacute;finir comme emplacement par d&eacute;faut pour la bo&icirc;te de dialogue de fichier.</p></li><li class="list__item" id="-211zd0_537"><p><code class="code" id="-211zd0_538">fd.Show()</code> affichera la bo&icirc;te de dialogue de fichier &agrave; l'utilisateur.</p></li></ul><p id="-211zd0_539">La fonction de rappel pour g&eacute;rer l'ouverture du fichier est d&eacute;finie comme suit :</p><div class="code-block" data-lang="go">
func getOpenFileDialogFunc(w fyne.Window, src *widget.Entry, dst *widget.RichText) func(reader fyne.URIReadCloser, err error) {
	return func(reader fyne.URIReadCloser, err error) {
		if err != nil {
			dialog.ShowError(err, w)
			return
		}
		if reader == nil {
			log.Println(&quot;Annulé&quot;)
			return
		}
		data, err := io.ReadAll(reader)
		if err != nil {
			fmt.Println(err)
		}
		src.SetText(string(data))
		dst.ParseMarkdown(string(data))
	}
}
</div><p id="-211zd0_541">Cette fonction retourne une autre fonction qui fait ce qui suit lorsqu'elle est invoqu&eacute;e :</p><ul class="list _bullet" id="-211zd0_542"><li class="list__item" id="-211zd0_543"><p>Elle v&eacute;rifie et affiche toute erreur potentielle.</p></li><li class="list__item" id="-211zd0_544"><p>Si <code class="code" id="-211zd0_545">reader</code> est <code class="code" id="-211zd0_546">nil</code>, elle consigne <code class="code" id="-211zd0_547">&quot;Annul&eacute;&quot;</code>.</p></li><li class="list__item" id="-211zd0_548"><p>Elle lit toutes les donn&eacute;es du fichier, fixe le texte comme contenu de <code class="code" id="-211zd0_549">src</code> (un <code class="code" id="-211zd0_550">widget.Entry</code>), et transforme le texte en format Markdown dans <code class="code" id="-211zd0_551">dst</code> (un <code class="code" id="-211zd0_552">widget.RichText</code>), pour le pr&eacute;visualiser dans l'autre partie de la fen&ecirc;tre de l'application.</p></li></ul><p id="-211zd0_553">Les fonctions anonymes pour le bouton <span class="emphasis" id="-211zd0_554">&quot;Enregistrer&quot;</span> sont similaires en termes de structure, mais la fonction est inverse, c.-&agrave;-d. que le texte contenu dans <code class="code" id="-211zd0_555">src</code> est enregistr&eacute; dans le fichier s&eacute;lectionn&eacute; &agrave; la place d'&ecirc;tre lu et affich&eacute;.</p></section><div class="last-modified">Last modified: 03 avril 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="ch09s05-exemple-5-contenants.html" class="navigation-links__prev">Exemple 5 : Contenants</a><a href="ch09s07-exemple-7-menu.html" class="navigation-links__next">Exemple 7 : Menu</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.6.6-b224/app.js"></script></body></html>